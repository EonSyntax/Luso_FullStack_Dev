{% extends 'base.html' %}
{% block content %}
{% load static %}

{% include 'includes/navbar.html'%}

<main class="main">

    <!-- Page Title -->
    <div class="page-title dark-background" data-aos="fade" style="background-image: url('{% static "assets/img/testimonials-bg.avif" %}');">
      <div class="container position-relative">
        <h1>Blog</h1>
        <nav class="breadcrumbs">
          <ol>
            <li><a href="{% url 'index' %}">Home</a></li>
            <li class="current">Blog</li>
          </ol>
        </nav>
      </div>
    </div><!-- End Page Title -->

<!-- Blog Section -->
    <section id="blog" class="blog section">

        <!-- Section Title -->
        <div class="container section-title" data-aos="fade-up">
            <h2 class="df">Blog</h2>
            <p></p>
        </div><!-- End Section Title -->

        <div class="container">
            <div class="row gy-4">

                <!-- Blog Card -->
                 {% for blog in blogs %}
                <div class="col-md-3">
                  <div class="blog-card">
                  <a href="{% url 'blog_detail' blog.id %}"> <!-- <a href="{% url 'blog_detail' blog.id %}"> -->
                      <img src="{{ blog.image.url }}" alt="Blog Image">
                    </a>
                    <div class="card-body p-3">
                      <div class="blog-meta">
                        <i class="far fa-user"></i> {{ blog.author.username }} &nbsp; `
                        <br>
                        <span><i class="fas fa-calendar-check"></i> {{ blog.created_at|date:"M d, Y" }}</span> • <span><i class="far fa-clock"></i> {{ blog.read_time }} min read</span>
                      </div>
                      <h5>
                        <a href="{% url 'blog_detail' blog.id %}" class="text-decoration-none text-dark"> <!-- <a href="{% url 'blog_detail' blog.id %}"> -->
                          {{ blog.title }}
                        </a>
                      </h5>
                    </div>
                    <div class="blog-footer p-3 d-flex justify-content-between align-items-center">
                      <div>
                        <i class="bi bi-eye"></i> {{ blog.views }}
                        <i class="bi bi-chat"></i> 0
                      </div>
                      <div>
                        <a href="javascript:void(0)" class="like-btn" data-id="{{ blog.id }}">
                          <i class="bi bi-heart"></i> <span class="like-count">{{ blog.likes }}</span>
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
                {% endfor %}

                <!-- Add more cards as needed -->

            </div>
        </div> <!-- End Blog Section -->

    </section><!-- End Blog Section -->

  </main>

{% include 'includes/footer.html' %}

<script>
document.querySelectorAll(".like-btn").forEach(btn => {
  btn.addEventListener("click", function() {
    const blogId = this.dataset.id;
    const icon = this.querySelector("i");
    const count = this.querySelector(".like-count");

    fetch(`/blog/${blogId}/like/`)
      .then(res => res.json())
      .then(data => {
        count.textContent = data.likes;
        icon.classList.remove("bi-heart");
        icon.classList.add("bi-heart-fill", "text-danger"); // ❤️ turns red
      });
  });
});
</script>


  {% endblock %}